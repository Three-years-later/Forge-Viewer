# BubbleNode

### new BubbleNode(rawNode, parent)

包装和帮助程序用于“冒泡”数据。

冒泡是可以从单个种子文件生成的各种2D或3D可视对象(和其他数据)的容器。冒泡是具有不同角色的节点的JSON结构，例如，它们可以表示图纸，嵌套的2D/3D几何图形等。

此类包装了冒泡的内部表示形式，并添加了一些辅助方法。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
rawNode<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*object*</font>|冒泡JSON中的原始节点。
parent&nbsp;<font color=gray size=2>*object*</font>|冒泡JSON的父节点。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

## Methods(方法)

### isOtg()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
bool&nbsp;<font color=gray size=2>*object*</font>|如果冒泡层次结构包含嵌入式otg清单，则为true。

### getOtgGraphicsNode()

从otg清单返回可见的OTG(如果可用，否则为未定义)

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Autodesk.Viewing.BubbleNode，未定义|&nbsp;

### getPropertyDbManifest()

返回属性数据库文件的列表。以前，对于v1，此列表已在PropWorker /中进行了硬编码。此功能了解v2和OTG属性数据库的跨版本共享

### getRootNode()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Autodesk.Viewing.BubbleNode|最顶部的冒泡节点。

### isForgeManifest()

清单是否来自Forge (modelDerivativeV2)或者不是(derivativeV2)。仅适用于根节点。内部使用。

### findPropertyDbPath()

查找共享属性数据库（如果有）。

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|共享属性数据库路径，或为null。

### name()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|节点名称。

### guid()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|节点GUID(全局唯一标识符)。

### type()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|节点类型。

### extensions()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Array.\<string>|扩展ID数组或未定义。

### urn(searchParent)

检索节点或其最接近的祖先的URN。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
searchParent<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*boolean*</font>|如果URN对于该节点不可用，则也搜索其祖先。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|可见的URN。

### isGeomLeaf()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为几何页节点

### isViewable()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断节点是否可见

### getLodNode()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为LOD节点

### isGeometry()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为几何节点

### isViewPreset()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|这是视图预设/摄像定义节点。

### is2D()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为2D节点

### is3D()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为3D节点

### is2DGeom()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为2D几何节点

### is3DGeom()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为3D几何节点

### useAsDefault()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|如果打算首先加载该节点，则为true

### getDefaultGeometry()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
BubbleNode|标记为useAsDefault = true的几何节点。如果没有找到，它将返回this.search({'type'：'geometry'})的第一个元素。

### getPlacementTransform()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
object|节点的放置变换

### isMetadata()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|判断是否为元数据节点

### findViewableParent()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Autodesk.Viewing.BubbleNode|可见的层次结构中的第一父级。如果在顶层设计节点上调用，则返回可见的设计节点的第一个子节点。

### findParentGeom2Dor3D(options)

<font color=gray size=4>**参数**</font>

type(类型)|description(描述)
:-:|:-:|
options&nbsp;<font color=gray size=2>object</font>|提前使用选项
fallbackParent&nbsp;<font color=gray size=2>Autodesk.Viewing.BubbleNode</font>|在遍历父链后没有可用的几何节点时返回。

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Autodesk.Viewing.BubbleNode|层次结构中为2D或3D几何图形的第一父级。

### findAllViewables()

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Array.<Autodesk.Viewing.BubbleNode>|包含此节点下所有可见元素的数组

### getViewableRootPath(ignoreLeaflet)

在此节点及其所有子节点中查找可见的根路径。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
ignoreLeaflet<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*boolean*</font>|如果设置，它将跳过任何图像金字塔子节点，并返回F2D文件的路径（如果有）。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
string|可见的根路径，或为null。

### getNamedViews()

返回可见中的所有命名视图。命名视图是从包含照相机信息和字符串标识符的文档清单中获得的。

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
array|所有命名视图。如果未找到，则返回空数组。

### findByGuid(guid)

从冒泡返回与GUID匹配的第一个节点。

请注意，冒泡中的某些GUID不是唯一的，如果您希望此功能获得正确的结果，则必须确保您正在寻找唯一的GUID。否则，请使用常规搜索。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
guid<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*string*</font>|节点GUID。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Autodesk.Viewing.BubbleNode|匹配的冒泡节点，或者为null。

### search(propsToMatch)

从冒泡中找到与一个或多个属性匹配的节点。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
propsToMatch<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*object*</font>|过滤条件：要匹配，节点必须具有指定的属性和值。使用逗号分隔的属性：值对或命名的预设对象(请参见下面示例中的注释)。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
Array.\<BubbleNode>|匹配节点，或者为null。

<font color=gray size=4>**例子**</font>

```js
//Filter criteria syntax(过滤条件语法):
// { “property”:”value” [, “property”:”value”, ...] }
// 或使用命名的预设对象:
// BubbleNode.MODEL_NODE { “role”:”3d”, “type”:”geometry” }
// BubbleNode.GEOMETRY_SVF_NODE { “role”:”graphics”, “mime”: “application/autodesk-svf” }
// BubbleNode.SHEET_NODE { “role”:”2d”, “type”:”geometry” }
// BubbleNode.LEAFLET_NODE { “role”:”leaflet” }
// BubbleNode.IMAGE_NODE { “role”:”image” }
// BubbleNode.GEOMETRY_F2D_NODE { “role”:”graphics”, “mime”: “application/autodesk-f2d” }
// BubbleNode.VIEWABLE_NODE { “role”:”viewable” }
// BubbleNode.AEC_MODEL_DATA { “role”:”Autodesk.AEC.ModelData”}

var singleProps = myBubbleNode.search({
    "type": "geometry"
});
var multiProps = myBubbleNode.search({
    "role": "3d",
    "type": "geometry"
});
var presetProps = myBubbleNode.search(myBubbleNode.SHEET_NODE);
```

### traverse(cb)

递归遍历该冒泡，为每个节点调用一个回调函数，只要该回调函数保持返回false即可。

<font color=gray size=4>**参数**</font>

Term|Definition
:-:|:-:|
cb<font color=red size=2>\*</font>&nbsp;<font color=gray size=2>*function*</font>|回调函数，接受冒泡节点作为参数，如果应该终止遍历，则返回true。

<font color=red size=2>\*</font><font color=red size=2>必填</font>

<font color=gray size=4>**Returns**</font>

type(类型)|description(描述)
:-:|:-:|
boolean|上次回调调用的结果。

### getLevel()

返回此冒泡节点的Revit Level/Floor。目前仅与来自Revit的二维图纸相关。

### getLevelName()

返回此冒泡节点的Revit Level/Floor名称。目前仅与来自Revit的二维图纸相关。
