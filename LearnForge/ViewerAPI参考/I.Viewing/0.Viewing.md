# Viewing

包含公共API类，函数，常量和事件的名称空间。

## 方法

### 初始化程序(选项,回调)

用于初始化Viewer运行时的静态方法。完成此步骤后，必须加载模型。

包括：

Viewer使用的云服务的端点，例如客户端上的模型衍生身份验证和授权cookie设置其他运行时环境变量和全局Viewer配置参数

<font color=gray size=4>**参量**</font>

Term|Definition
:-:|:-:|
options<font color=red size=2>*</font> <font color=gray size=2>object</font>|options对象包含用于初始化的配置参数。如果没有提供访问令牌或身份验证回调，则初始化器将返回URL查询字符串中提供的访问令牌，或者存储在cookie缓存中的先前访问令牌（如果有）。
env <font color=gray size=2>string</font>|可以使用“ AutodeskProduction”，“ AutodeskStaging”或“ AutodeskDevelopment”。“ Local”避免将征服标题附加到XHR请求。
api <font color=gray size=2>string</font>|在美国数据中心使用“ modelDerivativeV2”或“ derivativeV2”，在欧洲数据中心使用“ derivativeV2_EU”。
getAccessToken <font color=gray size=2>function</font>|异步提供访问令牌的函数。函数签名为**getAccessToken(onSuccess)**，其中onSuccess是在授予令牌后getAccessTokenfunction应该调用的回调，令牌是onSuccess函数的第一个输入参数，令牌到期时间(以秒为单位)是该功能的第二个输入参数。Viewer依赖于getAccessToken和到期时间来自动更新令牌，因此至关重要的是必须按此处所述实现getAccessToken。
accessToken <font color=gray size=2>string</font>|访问令牌。提供**options.getAccessToken**时不需要。
webGLHelpLink <font color=gray size=2>string</font>|到webGL上帮助页面的链接（如果已禁用）。
language <font color=gray size=2>string</font>|RFC 4646中定义的首选语言代码，例如“ en”，“ de”，“ fr”等。如果未设置任何语言，则Viewer将从浏览器中选择它。如果语言不是RFC中定义的语言，则Viewer将退回到“ en”（英语），但是行为未定义。
callback<font color=red size=2>*</font> <font color=gray size=2>function</font>|初始化完成后，客户端执行的方法。
<font color=red size=2>*</font><font color=red size=2>必填</font>

<font color=gray size=4>**例子**</font>

```js
var options = {
  env: "AutodeskProduction",
  language: "en",
  getAccessToken: function(onSuccess) {
    // 待办事项：获取实际的伪造令牌和有效时间。
    var accessToken = 'your_access_token';
    var expirationTimeSeconds = 5 * 60; // 5 minutes
    onSuccess(accessToken, expirationTimeSeconds);
  }
};
var myCallback = function() {
  console.log("initialization complete, creating the viewer...");
};
Autodesk.Viewing.Initializer(options, myCallback);
```

----

### shutdown()

与Autodesk.Viewing.Initializer相对，使用它释放内存。开发人员需要在调用此功能之前取消初始化所有Autodesk.Viewing.Viewer3D实例。

## 常数

### 默认设置

Viewer的默认设置。有关每个设置的更多信息，请参考“[设置](https://forge.autodesk.com/en/docs/viewer/v7/reference/globals/Settings/)”。

----

类型

----

[设定值](https://forge.autodesk.com/en/docs/viewer/v7/reference/globals/Settings/)

----

## 属性

Term|Definition
:-:|:-:|
viewCube <font color=gray size=2>*boolean*</font>|默认值：true。设置视图多维数据集的可见性。对于移动设备设置为false。
alwaysUsePivot <font color=gray size=2>*boolean*</font>|默认值：false。轨迹控件始终围绕当前设置的枢轴点旋转。
zoomTowardsPivot <font color=gray size=2>**</font>|默认值：false。相机手推车（缩放）操作的默认方向是朝向相机枢轴点。
reverseHorizontalLookDirection <font color=gray size=2>*boolean*</font>|默认值：false。设置视图导航选项以反转水平外观操作的默认方向。
reverseVerticalLookDirection <font color=gray size=2>*boolean*</font>|默认值：false。设置视图导航选项以反转垂直外观操作的默认方向。
orbitPastWorldPoles <font color=gray size=2>*boolean*</font>|默认值：true。设置视图导航选项，以允许轨道控件将摄像机移至北极和南极（世界上下方向）之外。
clickToSetCOI <font color=gray size=2>*boolean*</font>|默认值：false。修改Viewer的默认单击行为。
ghosting <font color=gray size=2>*boolean*</font>|默认值：true。在搜索和隔离期间切换重影。
optimizeNavigation <font color=gray size=2>*boolean*</font>|默认值：false。切换是否应针对性能优化导航。对于移动设备设置为true。
ambientShadows <font color=gray size=2>*boolean*</font>|默认值：true。启用或禁用环境阴影。
antialiasing <font color=gray size=2>*boolean*</font>|默认值：true。启用或禁用抗锯齿。对于移动设备设置为false。
groundShadow <font color=gray size=2>*boolean*</font>|默认值：true。切换地面阴影。
groundReflection <font color=gray size=2>*boolean*</font>|默认值：false。切换地面反射。
lineRendering <font color=gray size=2>*boolean*</font>|默认值：true。隐藏场景中的所有线。
edgeRendering <font color=gray size=2>*boolean*</font>|默认值：false。打开/关闭边缘拓扑显示（如果有）。
lightPreset <font color=gray size=2>*number*</font>|默认值：1.设置Viewer的灯光预设（环境）。
envMapBackground <font color=gray size=2>*boolean*</font>|默认值：false。切换背景的环境地图。
firstPersonToolPopup <font color=gray size=2>*boolean*</font>|默认值：true。切换第一人称工具弹出窗口。
bimWalkToolPopup <font color=gray size=2>*boolean*</font>|默认值：true。切换bimwalk工具弹出窗口。
grayscale <font color=gray size=2>*boolean*</font>|默认值：false。覆盖2D模型中的线条颜色以呈现灰色阴影。
swapBlackAndWhite <font color=gray size=2>*boolean*</font>|默认值：false。对于2D模型，将在黑色背景上切换为白线。
progressiveRendering <font color=gray size=2>*boolean*</font>|默认值：true。切换是否使用渐进式渲染。
openPropertiesOnSelect <font color=gray size=2>*boolean*</font>|默认值：false。选择对象时打开属性面板（仅适用于GuiViewer3D）。
pointRendering <font color=gray size=2>*boolean*</font>|默认值：true。隐藏场景中的所有点。
backgroundColorPreset|默认值：null。将颜色设置为背景。
reverseMouseZoomDir <font color=gray size=2>*boolean*</font>|默认值：false。反转相机手推车（缩放）操作的默认方向。
leftHandedMouseSetup <font color=gray size=2>*boolean*</font>|默认值：false。从默认设置中反转鼠标按钮（即，鼠标左键操作变为鼠标右键，反之亦然）。
fusionOrbit <font color=gray size=2>*boolean*</font>|默认值：true。将轨道设置为融合轨道。
fusionOrbitConstrained <font color=gray size=2>*boolean*</font>|默认值：true。将轨道设置为受限的融合轨道。
wheelSetsPivot <font color=gray size=2>*boolean*</font>|默认值：false。设置滚轮缩放动作，以将轨道枢轴自动重置到光标下方的位置。
selectionSetsPivot <font color=gray size=2>*boolean*</font>|默认值：false。设置选择/取消选择动作，以自动将轨道枢轴重置为多重选择的中心。
bimWalkNavigatorType <font color=gray size=2>*string*</font>|默认值：“默认”。设置BimWalk工具导航器。
defaultNavigationTool3D <font color=gray size=2>*string*</font>|默认值：“默认”。设置Viewer将使用的导航工具。（即：“ extractor_defined” ||“ bimwalk”）
loadingAnimation <font color=gray size=2>*boolean*</font>|默认值：true。切换2D模型的加载动画。

## 屏幕模式

可用的屏幕模式列表：

kNormal: 0 kFullBrowser: 1 kFullScreen: 2

type:number

## exports.TOOLBAR

Viwer工具栏

这些常量用于定义标准的工具栏

type:string

## Events(事件)

### ESCAPE_EVENT

按下Esc键时触发

### PROGRESS_UPDATE_EVENT

在打开模型/工程图的整个过程中反复触发

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
percent <font color=gray size=2>*number*</font>|估计进度。百分比。
state <font color=gray size=2>*number*</font>|来自Autodesk.Viewing.ProgressState的值，提供有关进度状态的详细信息。
model <font color=gray size=2>*object*</font>|正在加载模型。

### FULLSCREEN_MODE_EVENT

屏幕模式更改时触发

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
mode <font color=gray size=2>*Autodesk.Viewing.ScreenMode*</font>|新屏幕模式。

### NAVIGATION_MODE_CHANGED_EVENT

触发后，导航工具将更改

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
id <font color=gray size=2>*string*</font>|工具标识符。

### VIEWER_STATE_RESTORED_EVENT

还原Viewer状态时触发

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
value <font color=gray size=2>*bool*</font>|状态恢复成功。

### VIEWER_RESIZE_EVENT

当Viewer大小更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
width <font color=gray size=2>*number*</font>|Viewer视口窗新宽度。
height <font color=gray size=2>*number*</font>|Viewer视口窗新高度。

### VIEWER_INITIALIZED

Viewer完全初始化时触发。

### VIEWER_UNINITIALIZED

当Viewer完全未初始化时触发。

### LOADER_LOAD_FILE_EVENT

在创建Model实例之前，当Viewer开始加载模型时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
loader <font color=gray size=2>*object*</font>|Loader类的实例

### LOADER_LOAD_ERROR_EVENT

在加载期间检测到错误时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
loader <font color=gray size=2>*object*</font>|Loader类的实例。
error <font color=gray size=2>*object*</font>|加载程序报告的错误。

### MODEL_ROOT_LOADED_EVENT

当Viewer接收并解析初始模型清单时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
svf <font color=gray size=2>*object*</font>|解析 SVF/F2D 的JSON。
model <font color=gray size=2>*object*</font>|模型数据。

### GEOMETRY_LOADED_EVENT

当模型/工程图加载完成时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
model <font color=gray size=2>*object*</font>|模型数据。

### TEXTURES_LOADED_EVENT

当模型/工程图纹理加载完成时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
model <font color=gray size=2>*object*</font>|模型数据。

### OBJECT_TREE_CREATED_EVENT

成功创建实例树时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
svf <font color=gray size=2>*object*</font>|解析 SVF/F2D 的JSON。
model <font color=gray size=2>*object*</font>|模型数据。

### OBJECT_TREE_UNAVAILABLE_EVENT

解析实例树时发生错误时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
svf <font color=gray size=2>*object*</font>|解析 SVF/F2D 的JSON。
model <font color=gray size=2>*object*</font>|模型数据。

### OBJECT_TREE_LOAD_PROGRESS_EVENT

在propertyDB加载期间发生进度事件时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
svf <font color=gray size=2>*object*</font>|解析 SVF/F2D 的JSON。
model <font color=gray size=2>*object*</font>|模型数据。

### MODEL_UNLOADED_EVENT

从Viewer中删除模型时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
model <font color=gray size=2>*object*</font>|模型数据。

### MODEL_ADDED_EVENT

将模型添加到模型队列以使其可见时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
model <font color=gray size=2>*object*</font>|模型数据。

### MODEL_REMOVED_EVENT

从模型队列中删除模型（即更改为不可见）时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
model <font color=gray size=2>*object*</font>|模型数据。

### MODEL_LAYERS_LOADED_EVENT

成功加载模型的图层时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
root <font color=gray size=2>*object*</font>|模型层是根。
model <font color=gray size=2>*object*</font>|模型数据。

### EXTENSION_LOADED_EVENT

Viewer扩展成功加载时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
extensionId <font color=gray size=2>*string*</font>|扩展名标识符。

### EXTENSION_UNLOADED_EVENT

Viewer扩展成功卸载时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
extensionId <font color=gray size=2>*string*</font>|扩展名标识符。

### SELECTION_CHANGED_EVENT

选定对象列表更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
fragIdsArray <font color=gray size=2>*Array.\<number>*</font>|所选对象的片段ID。
dbIdArray <font color=gray size=2>*Array.\<number>*</font>|所选对象的dbId。
nodeArray <font color=gray size=2>*Array.\<number>*</font>|与dbIdArray相同。
model <font color=gray size=2>*object*</font>|模型数据。

### AGGREGATE_SELECTION_CHANGED_EVENT

当所选对象的列表在多模型上下文中更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
selections <font color=gray size=2>*Array.\<object>*</font>|包含每个模型的{@link Autodesk.Viewing＃SELECTION_CHANGED_EVENT}的典型选择属性的对象列表。

### ISOLATE_EVENT

当查看者隔离一组对象时触发（即，使其他所有内容都不可见或重影）。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
nodeIdArray <font color=gray size=2>*Array.\<number>*</font>|隔离节点ID的列表。
model <font color=gray size=2>*object*</font>|模型数据。

### AGGREGATE_ISOLATION_CHANGED_EVENT

当隔离对象的列表在多模型上下文中更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
isolation <font color=gray size=2>*Array.\<object>*</font>|包含每个模型的{ @链接 Autodesk.Viewing＃ISOLATE_EVENT} 的典型选择属性的对象列表。

### HIDE_EVENT

当Viewer隐藏一组对象时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
nodeIdArray <font color=gray size=2>*Array.\<number>*</font>|隐藏节点ID的列表。
model <font color=gray size=2>*object*</font>|模型数据。

### AGGREGATE_HIDDEN_CHANGED_EVENT

当隐藏对象的列表在多模型上下文中更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
hidden <font color=gray size=2>*Array.\<object>*</font>|包含每个模型的{ @链接 Autodesk.Viewing＃HIDE_EVENT} 的典型选择属性的对象列表。

### SHOW_EVENT

当Viewer显示一组对象时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
nodeIdArray <font color=gray size=2>*Array.\<number>*</font>|隐藏节点ID的列表。
model <font color=gray size=2>*object*</font>|模型数据。

### SHOW_PROPERTIES_EVENT

触发以显示对象的属性。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
dbId <font color=gray size=2>*number*</font>|对象的dbId。
model <font color=gray size=2>*object*</font>|模型数据。

### SHOW_ALL_EVENT

每当使用**viewer.showAll()**时触发。

### CAMERA_CHANGE_EVENT

相机更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
camera <font color=gray size=2>*object*</font>|受影响的相机。

### EXPLODE_CHANGE_EVENT

每当使用分解(Explode)工具时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
scale <font color=gray size=2>*number*</font>|当前分解状态的比例。

### FIT_TO_VIEW_EVENT

当应用**fitToView**操作时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
immediate <font color=gray size=2>*boolean*</font>|如果更改是立即的，则为true。
nodeIdArray <font color=gray size=2>*Array.\<number>*</font>|已安装的节点ID列表。拟合整个模型时，数组为空。
model <font color=gray size=2>*object*</font>|模型数据。

### AGGREGATE_FIT_TO_VIEW_EVENT

当应用**fitToView**操作时触发，支持多模型上下文。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
selection <font color=gray size=2>*Array.\<object>*</font>|对象列表，每个对象包含一个模型实例和一个id选择数组。

### CUTPLANES_CHANGE_EVENT

切割平面更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
planes <font color=gray size=2>*Array.\<object>*</font>|切割列表。

### TOOL_CHANGE_EVENT

激活或停用工具时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
toolName <font color=gray size=2>*string*</font>|工具特定模式的名称。
tool <font color=gray size=2>*object*</font>|工具对象。
active <font color=gray size=2>*bool*</font>|工具的当前状态。

### RENDER_OPTION_CHANGED_EVENT

渲染选项更改时触发。

### FINAL_FRAME_RENDERED_CHANGED_EVENT

当Viewer显示的渲染帧是最终的或完整的（不再具有任何待处理的几何图形或后期处理效果，不会延迟传入帧）或Viewer停止显示最终帧时，将触发此事件。名称是指渲染器的状态从忙碌变为空闲时，反之亦然。要知道何时完全显示所有几何图形，还请检查GEOMETRY_LOADED_EVENT。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
finalFrame <font color=gray size=2>*bool*</font>|最后一帧显示此刻度。

### RENDER_PRESENTED_EVENT

当渲染呈现到屏幕时触发。

### LAYER_VISIBILITY_CHANGED_EVENT

当2D图层的可见性更改时触发。

### REF_CHANGED_EVENT

用户首选项属性更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
name <font color=gray size=2>*string*</font>|属性名称。
value <font color=gray size=2>*object*</font>|新属性值。

### PREF_RESET_EVENT

用户首选项属性更改时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
name <font color=gray size=2>*string*</font>|属性名称。
value <font color=gray size=2>*object*</font>|新属性值。

### RESTORE_DEFAULT_SETTINGS_EVENT

由于调用**viewer.restoreDefaultSettings()**恢复默认设置而被触发。在所有其他Autodesk.Viewing.PREF_CHANGED_EVENT被解雇后将被解雇。

### ANIMATION_READY_EVENT

成功初始化动画时触发。

### CAMERA_TRANSITION_COMPLETED

每当照相机过渡完成时都会触发，例如“焦点”，“转到主视图”，“还原状态”，“还原命名视图”等。

### HYPERLINK_EVENT

当用户单击模型中嵌入的超链接时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
data <font color=gray size=2>*object*</font>|超链接数据。

### LOAD_MISSING_GEOMETRY

当视图中的某些更改可能会暴露丢失的几何图形时触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
delay <font color=gray size=2>*boolean*</font>|用于在用户交互期间聚合多个事件的标志。默认为true。

### WEBGL_CONTEXT_LOST_EVENT

与WebGLRenderingContext对象关联的绘图缓冲区丢失时触发

### CANCEL_LEAFLET_SCREENSHOT

在下载所有必需/待处理的图块之前需要取消传单屏幕截图时触发。

### SET_VIEW_EVENT

成功调用{Autodesk.Viewing.Viewer3D＃setView}后触发。

<font color=gray size=4>**属性**</font>

Term|Definition
:-:|:-:|
view <font color=gray size=2>*[Autodesk.Viewing.BubbleNode](https://forge.autodesk.com/en/docs/viewer/v7/reference/Viewing/BubbleNode/)*</font>|应用的视图对象。

### RENDER_FIRST_PIXEL

当模型的第一个像素准备好渲染时触发。

### PROFILE_CHANGE_EVENT

将配置文件添加到Viewer时触发。

### PROFILE_CHANGE_EVENT

当场景部件即将被渲染时触发

### OBJECT_UNDER_MOUSE_CHANGED

当鼠标下的对象改变时触发。

### TOOLBAR_​​CREATED_EVENT

工具栏UI实例化后触发。

### SETTINGS_PANEL_CREATED_EVENT

实例化“设置”面板后触发。

### VIEW_CUBE_CREATED_EVENT

实例化ViewCube后触发。
