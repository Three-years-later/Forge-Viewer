# Profiles(如何使用配置文件API)

通过Profile API，您可以指定要在Viewer中加载或卸载的*首选项*值和*扩展名*。

>本教程将介绍以下内容：
>
>* 使用内置配置文件将设置应用于查看器。
>* 创建自定义配置文件。
>* 用特定文件类型注册自定义配置文件。
>* 用自定义配置文件覆盖默认配置文件。

## 使用内置配置文件

Viewer提供内置的即用型配置文件，这些配置文件提供与Navisworks和Revit等台式机产品相同的用户体验。

有关更多信息，请参考：[ProfileSettings](https://forge.autodesk.com/en/docs/viewer/v7/reference/ProfileSettings/)

以下代码片段显示了如何使用Navisworks配置文件。

```js
const profileSettings = Autodesk.Viewing.ProfileSettings.Navis;
const profile = new Autodesk.Viewing.Profile(profileSettings);
viewer.setProfile(profile);
```

以下代码显示了如何使用AEC配置文件

```js
const profileSettings = Autodesk.Viewing.ProfileSettings.AEC;
const profile = new Autodesk.Viewing.Profile(profileSettings);
viewer.setProfile(profile);
```

## 创建自定义配置文件

也可以设置自定义配置文件。自定义配置文件可以覆盖现有首选项，卸载/加载特定扩展并将首选项设置为持久性。

有关更多信息，请参考：[Profile](https://forge.autodesk.com/en/docs/viewer/v7/reference/Viewing/Profile/)

以下代码段覆盖了两个首选项，添加了新的首选项，卸载了两个扩展名，并将一些首选项设置为在浏览器会话之间保持不变。

```js
const customProfileSettings = {
settings: {
  reverseMouseZoomDir: true, // 覆盖现有
  reverseHorizontalLookDirection: true, // 覆盖现有
  customSettingOne: true, // new preference
  customSettingTwo: 2, // new preference
  customSettingThree: 'test' // new preference
},
extensions: {
    unload: ['Autodesk.ViewCubeUi', 'Autodesk.BimWalk']
}
};
const customProfile = new Autodesk.Viewing.Profile(customProfileSettings);
// 更新封装在配置文件中的查看器设置。
// 此方法还将加载和卸载配置文件引用的扩展。
viewer.setProfile(customProfile);
```

可以从现有配置文件设置中克隆自定义配置文件。在以下代码段中，配置文件设置是从AEC配置文件设置中克隆的。除了AEC配置文件设置外，选择对象时还将打开属性面板，并且将关闭渐进式渲染。

```js
const aecProfileSettings = Autodesk.Viewing.ProfileSettings.AEC;
// 自定义配置文件设置是从AEC配置文件设置中克隆的。
const customProfileSettings = Autodesk.Viewing.ProfileSettings.clone(aecProfileSettings);
// 关闭渐进式渲染
customProfileSettings.settings.progressiveRendering = false;
// 选择对象时，打开属性面板。
customProfileSettings.settings.openPropertiesOnSelect = true;

const customProfile = new Autodesk.Viewing.Profile(customProfileSettings);
viewer.setProfile(customProfile);
```

## 注册特定文件类型的自定义配置文件

使用ProfileManager(viewer.profileManager)注册具有特定文件类型的自定义配置文件。

有关更多信息，请参考：[ProfileManager](https://forge.autodesk.com/en/docs/viewer/v7/reference/Viewing/ProfileManager/)

要使用注册的文件配置文件，请确保设置以下配置标志：

```js
const config3d = {
  useFileProfile: true
};
const viewer = new Autodesk.Viewing.GuiViewer3D(viewerElement, config3d);
```

在初始化期间，使用dwf文件类型注册自定义配置文件。

```js
Autodesk.Viewing.Initializer(initOptions, function() {
  const profileSettings = {
    name: 'DWF',
    settings: {
      // 关闭渐进式渲染
      progressiveRendering: false,
      // 选择对象时，打开属性面板。
      openPropertiesOnSelect: true
    }
  };
  viewer.profileManager.registerProfile('dwf', profileSettings);
  viewer.start();
  // 应该是从dwf模型派生的气泡节点。
  Autodesk.Viewing.Document.load(urn, (lmvDocument) => {
    const geometryItems = lmvDocument.getRoot().search({ type: 'geometry' });
    const defaultItem = geometryItems[0];
    viewer.loadDocumentNode(lmvDocument, defaultItem, config3d);
  });
});
```

## 无论加载的文件类型如何，都使用自定义配置文件

您可以将自定义配置文件设为任何文件类型的默认配置文件。下面的代码示例演示了如何使用自定义配置文件覆盖默认配置文件。

```js
viewer.profileManager.registerProfile('default', profileSettings);
```

## 恢复默认配置文件

以下代码段将还原查看器中可用的默认配置文件。

```js
// 获取注册的默认配置文件
const defaultProfile = viewer.profileManager.getProfileOrDefault();
// 设置默认配置文件
viewer.setProfile(defaultProfile);
```
