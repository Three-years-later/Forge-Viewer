# 添加自定义几何

使用Viewer，您可以使用viewer.overlay API将小型自定义几何图形添加到场景中。

使用此功能可以将其他数据叠加到加载的模型上。即使启用渐进式渲染，添加到叠加场景中的每个自定义几何图形也会在每帧上进行渲染。

当过多的自定义几何图形添加到叠加场景中时，帧速率将下降。

自定义几何图形使用主场景深度缓冲区进行深度测试，从而允许自定义几何图形出现在加载的模型中。

[SceneBuilder](https://forge.autodesk.com/en/docs/viewer/v7/developers_guide/advanced_options/scene-builder/) API可用于添加可以逐渐渲染的对象

## Step 1: 创建自定义几何

Viewer捆绑了three.js库的版本71，并通过全局变量**THREE**公开了其功能。 让我们用它来创建一个红色的球体。

```js
var geom = new THREE.SphereGeometry(10, 8, 8);
var material = new THREE.MeshBasicMaterial({ color: 0xff0000 });
var sphereMesh = new THREE.Mesh(geom, material);
sphereMesh.position.set(1, 2, 3);
```

## Step 2: 创建叠加场景

自定义几何必须添加到叠加场景中。多个自定义几何可以共存于同一场景中。场景是通过名称创建和标识的。确保选择一个与查看器创建的场景不冲突的名称。

```js
if (!viewer.overlays.hasScene('custom-scene')) {
  viewer.overlays.addScene('custom-scene');
}
```

## Step 3: 将自定义几何图形添加到叠加场景

需要将自定义几何添加到特定的叠加场景中。 在此示例中，我们将自定义几何体**sphereMesh**添加到名为“ custom-scene”的场景中。

```js
viewer.overlays.addMesh(sphereMesh, 'custom-scene');
```

## Step 4: 从叠加场景中删除自定义几何

您可以使用**removeMesh()**和**removeScene()**删除自定义几何图形和叠加场景。

```js
viewer.overlays.removeMesh(sphereMesh, 'custom-scene');
viewer.overlays.removeScene('custom-scene');
```

查看器不会处理自定义几何图形所使用的几何图形或材质。应用程序开发人员可以释放内存。

```js
// 一旦材质和几何图形不再被其他任何网格物体使用，则需要对其进行处置，以避免内存泄漏。
material.dispose();
geom.dispose();
```

>请查看OverlayManager API文档页面以查看所有可用方法。
