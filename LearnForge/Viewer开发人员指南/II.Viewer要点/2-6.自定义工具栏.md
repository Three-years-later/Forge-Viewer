# 自定义工具栏

通过查看示例可以最好地说明如何自定义工具栏。

本示例在Viewer画布上创建带有两个按钮的自定义工具栏。每个按钮都有其自己的工具提示，并对单击事件做出反应。单击一个按钮显示环境背景，而单击另一个按钮将其隐藏。

![示例图05](https://developer.doc.autodesk.com/bPlouYTd/264/_images/custom_toolbar5.jpg)

## 开始之前

编译逻辑代码实现扩展。

```js
function ToolbarExtension(viewer, options) {
  Autodesk.Viewing.Extension.call(this, viewer, options);
}

ToolbarExtension.prototype = Object.create(Autodesk.Viewing.Extension.prototype);
ToolbarExtension.prototype.constructor = ToolbarExtension;

ToolbarExtension.prototype.load = function() {
  // Set background environment to "Infinity Pool"
  // and make sure the environment background texture is visible
  this.viewer.setLightPreset(6);
  this.viewer.setEnvMapBackground(true);

  // Ensure the model is centered
  this.viewer.fitToView();

  return true;
};

ToolbarExtension.prototype.unload = function() {
  // nothing yet
};

Autodesk.Viewing.theExtensionManager.registerExtension('ToolbarExtension', ToolbarExtension);
```

## Step 1: 检测工具栏

在自定义扩展中，重写method方法**onToolbarCreated**。 工具栏可用于扩展程序时，查看器将调用此方法。

```js
ToolbarExtension.prototype.onToolbarCreated = function(toolbar) {
  alert('TODO: customize Viewer toolbar');
};
```

## Step 2: 添加按钮

要创建一个子工具栏并添加几个按钮：

```js
ToolbarExtension.prototype.onToolbarCreated = function(toolbar) {
  // alert('TODO: customize Viewer toolbar');

  var viewer = this.viewer;

  // Button 1
  var button1 = new Autodesk.Viewing.UI.Button('show-env-bg-button');
  button1.onClick = function(e) {
      viewer.setEnvMapBackground(true);
  };
  button1.addClass('show-env-bg-button');
  button1.setToolTip('Show Environment');

  // Button 2
  var button2 = new Autodesk.Viewing.UI.Button('hide-env-bg-button');
  button2.onClick = function(e) {
      viewer.setEnvMapBackground(false);
  };
  button2.addClass('hide-env-bg-button');
  button2.setToolTip('Hide Environment');

  // SubToolbar
  this.subToolbar = new Autodesk.Viewing.UI.ControlGroup('my-custom-toolbar');
  this.subToolbar.addControl(button1);
  this.subToolbar.addControl(button2);

  toolbar.addControl(this.subToolbar);
};
```

注意，上面的代码调用method方法**addClass()**，该方法添加了一个CSS类来控制自定义按钮的外观。

在此示例中，我们将样式定义添加到HTML文件中：

```html
<style>
  .show-env-bg-button {
    background: red;
  }
  .hide-env-bg-button {
    background: blue;
  }
</style>
```

刷新HTML页面时，将显示按钮。将鼠标悬停在它们上方会显示工具提示。单击以触发他们的动作。

## Step 3: 清理

扩展应删除添加的所有DOM元素和事件。 在这种情况下，仅必须删除this.subToolbar。

```js
ToolbarExtension.prototype.unload = function() {
  if (this.subToolbar) {
      this.viewer.toolbar.removeControl(this.subToolbar);
      this.subToolbar = null;
  }
};
```

如编写扩展程序中所述，可以通过手动调用viewer.loadExtension（'ToolbarExtension'）和viewer.unload（'ToolbarExtension'）方法来验证扩展程序是否按预期工作。
